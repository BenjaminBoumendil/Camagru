<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8" />
    <title>Title</title>
  </head>

  <body>
    <!-- Header -->
    <?php include("html/header.php"); ?>

    <!-- Main -->
    <?php include("html/main.php"); ?>

    <!-- Side -->
    <?php include("html/side.php"); ?>

    <!-- Footer -->
    <?php include("html/footer.php"); ?>
  </body>

    <script>
      var video = document.querySelector('video');
      var canvas = document.querySelector('canvas');
      var ctx = canvas.getContext('2d');
      var localMediaStream = null;

      var errorCallback = function(e) {
        console.log('Reeeejected!', e);
      };

      function fallback() {
        console.log('getUserMedia missing');
      }

      function snapshot() {
        if (localMediaStream) {
          ctx.drawImage(video, 0, 0, 720, 720, 0, 0, 720, 720);
          // "image/webp" works in Chrome.
          // Other browsers will fall back to image/png.
          document.querySelector('img').src = canvas.toDataURL('image/webp');

          // send Image to server
          var file = document.getElementById('img-cam').files[0],
          xhr = new XMLHttpRequest();

          xhr.open('POST', 'server/imageManager.php');
          xhr.setRequestHeader('Content-Type', file.type);
          xhr.send(file);
        }
      }

      navigator.getUserMedia  = navigator.getUserMedia ||
                                navigator.webkitGetUserMedia ||
                                navigator.mozGetUserMedia ||
                                navigator.msGetUserMedia;

      if (!navigator.getUserMedia) {
        fallback();
      } else {
        var hdConstraints = {
          video: {
            mandatory: {
              maxWidth: 720,
              maxHeight: 720
            }
          }
        };

        video.addEventListener('click', snapshot, false);

        navigator.getUserMedia(hdConstraints, function(stream) {
            video.src = window.URL.createObjectURL(stream);
            localMediaStream = stream;

            video.onloadedmetadata = function(e) {
              // Ready to go. Do some stuff.
            };
        }, errorCallback);
      }
    </script>

</html>
